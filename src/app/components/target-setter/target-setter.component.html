<div class="target-setter-container">
  <header class="header">
    <h2>Configurar</h2>
    <p>Preferencias de {{ currentProfile }}</p>
  </header>

  <!-- Food Preferences Section -->
  <div class="food-preferences-section">
    <div class="food-preferences-content">
      <div class="pref-category" *ngFor="let category of macroCategories">
        <button class="pref-category-header" (click)="toggleCategory(category.key)">
          <span class="pref-category-info">
            <span class="pref-category-icon">{{ category.icon }}</span>
            <span class="pref-category-name">{{ category.label }}</span>
          </span>
          <span class="pref-category-count">{{ getPreferredCount(category.key) }}/{{ getTotalFoodCount(category.key) }}</span>
          <svg [class.rotated]="expandedCategory === category.key" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>

        <div class="pref-food-list" *ngIf="expandedCategory === category.key">
          <div class="pref-food-actions">
            <a class="pref-action-link" (click)="selectAllFoods(category.key)">Todos</a>
            <span class="pref-action-separator">|</span>
            <a class="pref-action-link" (click)="deselectAllFoods(category.key)">Ninguno</a>
          </div>
          <label
            class="pref-food-item"
            *ngFor="let food of getFoodsForCategory(category.key)"
            [class.selected]="isFoodPreferred(category.key, food.alimento)">
            <input
              type="checkbox"
              [checked]="isFoodPreferred(category.key, food.alimento)"
              (change)="toggleFoodPreference(category.key, food.alimento)">
            <span class="pref-food-emoji">{{ getFoodEmoji(food.alimento) }}</span>
            <span class="pref-food-name">{{ food.alimento }}</span>
          </label>
        </div>
      </div>
    </div>
  </div>
</div>
